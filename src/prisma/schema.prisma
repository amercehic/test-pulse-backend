generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model TestRun {
  id             Int      @id @default(autoincrement())
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  name           String
  triggeredBy    String
  status         String // 'passed' | 'failed'
  duration       Float
  commit         String
  branch         String
  framework      String
  browser        String
  browserVersion String
  platform       String
  tests          Test[]
}

model Test {
  id            Int     @id @default(autoincrement())
  name          String
  status        String // 'passed' | 'failed'
  duration      Float
  logs          String
  testRunId     Int
  testRun       TestRun @relation(fields: [testRunId], references: [id], onDelete: Cascade)
  previousRun   Test?   @relation("PreviousRun", fields: [previousRunId], references: [id])
  previousRunId Int?
  nextRun       Test[]  @relation("PreviousRun") // Opposite relation field
}

model TestHistory {
  id       Int      @id @default(autoincrement())
  name     String
  status   String   // 'passed' | 'failed'
  duration Float
  logs     String
}
